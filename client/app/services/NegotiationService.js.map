{"version":3,"sources":["../../src/services/NegotiationService.js"],"names":["HttpService","Negotiation","ApplicationException","NegotiationService","constructor","_http","_baseUrl","getNegotiationsByWeek","get","then","data","_instantiateNegotiation","getNegotiationsByLastWeek","getNegotiationsByBeforeLastWeek","map","obj","Date","date","quantity","value","getNegotiationsByPeriod","Promise","all","period","reduce","newArray","item","concat","sort","a","b","getTime","catch","err","console","log"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAOA,c;;AACAC,c;;AACAC,uB;;;AAGQ,SAAMC,kBAAN,CAAyB;AACvCC,kBAAc;AACb,UAAKC,KAAL,GAAa,IAAIL,WAAJ,EAAb;AACA,UAAKM,QAAL,GAAgB,oCAAhB;AACA;;AAEKC,yBAAN,GAA8B;AAAA;;AAAA;AAC7B,aAAO,MAAM,MAAKF,KAAL,CAAWG,GAAX,CAAgB,GAAE,MAAKF,QAAS,OAAhC,EAAwCG,IAAxC,CACZ,UAACC,IAAD;AAAA,cAAU,MAAKC,uBAAL,CAA6BD,IAA7B,CAAV;AAAA,OADY,EAEZ,YAAM;AACL,aAAM,IAAIR,oBAAJ,CAAyB,gCAAzB,CAAN;AACA,OAJW,CAAb;AAD6B;AAO7B;;AAEKU,6BAAN,GAAkC;AAAA;;AAAA;AACjC,aAAO,MAAM,OAAKP,KAAL,CAAWG,GAAX,CAAgB,GAAE,OAAKF,QAAS,WAAhC,EAA4CG,IAA5C,CACZ,UAACC,IAAD;AAAA,cAAU,OAAKC,uBAAL,CAA6BD,IAA7B,CAAV;AAAA,OADY,EAEZ,YAAM;AACL,aAAM,IAAIR,oBAAJ,CAAyB,qCAAzB,CAAN;AACA,OAJW,CAAb;AADiC;AAOjC;;AAEKW,mCAAN,GAAwC;AAAA;;AAAA;AACvC,aAAO,MAAM,OAAKR,KAAL,CAAWG,GAAX,CAAgB,GAAE,OAAKF,QAAS,iBAAhC,EAAkDG,IAAlD,CACZ,UAACC,IAAD;AAAA,cAAU,OAAKC,uBAAL,CAA6BD,IAA7B,CAAV;AAAA,OADY,EAEZ,YAAM;AACL,aAAM,IAAIR,oBAAJ,CAAyB,4CAAzB,CAAN;AACA,OAJW,CAAb;AADuC;AAOvC;;AAEDS,4BAAwBD,IAAxB,EAA8B;AAC7B,YAAOA,KAAKI,GAAL,CACLC,GAAD,IACC,IAAId,WAAJ,CAAgB,IAAIe,IAAJ,CAASD,IAAIE,IAAb,CAAhB,EAAoCF,IAAIG,QAAxC,EAAkDH,IAAII,KAAtD,CAFK,CAAP;AAIA;;AAEKC,2BAAN,GAAgC;AAAA;;AAAA;AAC/B,aAAO,MAAMC,QAAQC,GAAR,CAAY,CACxB,OAAKf,qBAAL,EADwB,EAExB,OAAKK,yBAAL,EAFwB,EAGxB,OAAKC,+BAAL,EAHwB,CAAZ,EAKXJ,IALW,CAKN,UAACc,MAAD;AAAA,cACLA,OAAOC,MAAP,CAAc,UAACC,QAAD,EAAWC,IAAX;AAAA,eAAoBD,SAASE,MAAT,CAAgBD,IAAhB,CAApB;AAAA,QAAd,EAAyD,EAAzD,EACEE,IADF,CACO,UAACC,CAAD,EAAIC,CAAJ;AAAA,eAAUA,EAAEb,IAAF,CAAOc,OAAP,KAAmBF,EAAEZ,IAAF,CAAOc,OAAP,EAA7B;AAAA,QADP,CADK;AAAA,OALM,EASXC,KATW,CASL,UAACC,GAAD,EAAS;AACfC,eAAQC,GAAR,CAAYF,GAAZ;AACA,aAAM,IAAI/B,oBAAJ,CAAyB,sCAAzB,CAAN;AACA,OAZW,CAAb;AAD+B;AAc/B;AAtDsC;;sBAAnBC,kB","file":"NegotiationService.js","sourcesContent":["import HttpService from \"../utils/HttpService\";\r\nimport Negotiation from \"../models/negotiation/Negotiation\";\r\nimport ApplicationException from \"../utils/exceptions/ApplicationException\";\r\n\r\n\r\nexport default class NegotiationService {\r\n\tconstructor() {\r\n\t\tthis._http = new HttpService();\r\n\t\tthis._baseUrl = \"http://localhost:3000/negotiations\";\r\n\t}\r\n\r\n\tasync getNegotiationsByWeek() {\r\n\t\treturn await this._http.get(`${this._baseUrl}/week`).then(\r\n\t\t\t(data) => this._instantiateNegotiation(data),\r\n\t\t\t() => {\r\n\t\t\t\tthrow new ApplicationException(\"Unable to get trades from week\");\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tasync getNegotiationsByLastWeek() {\r\n\t\treturn await this._http.get(`${this._baseUrl}/lastweek`).then(\r\n\t\t\t(data) => this._instantiateNegotiation(data),\r\n\t\t\t() => {\r\n\t\t\t\tthrow new ApplicationException(\"Unable to get trades from last week\");\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tasync getNegotiationsByBeforeLastWeek() {\r\n\t\treturn await this._http.get(`${this._baseUrl}/beforelastweek`).then(\r\n\t\t\t(data) => this._instantiateNegotiation(data),\r\n\t\t\t() => {\r\n\t\t\t\tthrow new ApplicationException(\"Unable to get trades from before last week\");\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\t_instantiateNegotiation(data) {\r\n\t\treturn data.map(\r\n\t\t\t(obj) =>\r\n\t\t\t\tnew Negotiation(new Date(obj.date), obj.quantity, obj.value)\r\n\t\t);\r\n\t}\r\n\r\n\tasync getNegotiationsByPeriod() {\r\n\t\treturn await Promise.all([\r\n\t\t\tthis.getNegotiationsByWeek(),\r\n\t\t\tthis.getNegotiationsByLastWeek(),\r\n\t\t\tthis.getNegotiationsByBeforeLastWeek(),\r\n\t\t])\r\n\t\t\t.then((period) =>\r\n\t\t\t\tperiod.reduce((newArray, item) => newArray.concat(item), [])\r\n\t\t\t\t\t.sort((a, b) => b.date.getTime() - a.date.getTime())\r\n\t\t\t)\r\n\t\t\t.catch((err) => {\r\n\t\t\t\tconsole.log(err);\r\n\t\t\t\tthrow new ApplicationException(\"Unable to get negotiations by period\");\r\n\t\t\t});\r\n\t}\r\n}\r\n"]}